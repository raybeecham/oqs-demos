<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <title>TLS Performance Test</title>
      <link rel="stylesheet" href="/static/style.css">
   </head>
   <body>
      <header>
         <div class="container">
            <div id="branding">
               <h1>Quantum-Safe Cryptography Tester</h1>
            </div>
            <nav>
               <ul>
                  <li class="current"><a href="/">Home</a></li>
               </ul>
            </nav>
         </div>
      </header>
      <section class="container">
         <h2>TLS Handshake Performance Test</h2>
         <form id="tls-test-form" action="/tls-perf/run-tls-perf-test" method="post">
            <label for="test_time">Test Time (seconds):</label>
            <input type="number" id="test_time" name="test_time" value="200" min="1" max="3600" required><br><br>
            <label for="kem_alg">KEM Algorithm:</label>
            <input type="text" id="kem_alg" name="kem_alg" value="kyber768" required pattern="^[a-zA-Z0-9_-]+$"><br><br>
            <label for="sig_alg">Signature Algorithm:</label>
            <input type="text" id="sig_alg" name="sig_alg" value="dilithium2" required pattern="^[a-zA-Z0-9_-]+$"><br><br>
            <input type="submit" value="Run TLS Performance Test" class="button run-test-button">
         </form>
         <!-- Loading module -->
         <div class="loading-module" style="display: none;">
            <div class="loading-spinner"></div>
            <p>Loading...</p>
         </div>
      </section>
      <script>
         document.getElementById('tls-test-form').addEventListener('submit', function(event) {
            var testTime = document.getElementById('test_time').value;
            var kemAlg = document.getElementById('kem_alg').value;
            var sigAlg = document.getElementById('sig_alg').value;
            var testTime = document.getElementById('test_time').value;
         
            // Define supported KEM algorithms
            var supportedKemAlgorithms = [
               'bikel1', 'bikel3', 'bikel5',
               'kyber512', 'kyber768', 'kyber1024',
               'frodo640aes', 'frodo640shake', 'frodo976aes', 'frodo976shake', 'frodo1344aes', 'frodo1344shake',
               'hqc128', 'hqc192', 'hqc256',
               // Add hybrid KEM algorithms
               'p256_kyber512', 'p384_kyber768', 'p521_kyber1024',
            ];
         
            // Define supported signature algorithms
            var supportedSigAlgorithms = [
               'dilithium2', 'dilithium3', 'dilithium5',
               'falcon512', 'falcon1024',
               'sphincssha2128fsimple', 'sphincssha2128ssimple', 'sphincssha2192fsimple', 'sphincssha2192ssimple', 'sphincssha2256fsimple', 'sphincssha2256ssimple',
               'sphincsshake128fsimple', 'sphincsshake128ssimple', 'sphincsshake192fsimple', 'sphincsshake192ssimple', 'sphincsshake256fsimple', 'sphincsshake256ssimple',
               // Add hybrid signature algorithms
               'rsa3072_dilithium2', 'p256_dilithium2', 'p384_dilithium3', 'p521_dilithium5',
            ];
         
            // Validate Test Time
            if(testTime === '' || isNaN(testTime) || testTime < 1 || testTime > 3600) {
               event.preventDefault();
               alert('Please enter a valid test time between 1 and 3600 seconds.');
               return false;
            }
         
            // Validate KEM Algorithm
            if(!supportedKemAlgorithms.includes(kemAlg)) {
               event.preventDefault();
               alert('Please enter a valid KEM Algorithm.');
               return false;
            }
         
            // Validate Signature Algorithm
            if(!supportedSigAlgorithms.includes(sigAlg)) {
               event.preventDefault();
               alert('Please enter a valid Signature Algorithm.');
               return false;
            }
         
         document.addEventListener("DOMContentLoaded", function() {
             var form = document.getElementById("tls-test-form");
             var runTestButton = form.querySelector(".run-test-button");
             var loadingModule = document.querySelector(".loading-module");
             
             runTestButton.addEventListener("click", function(event) {
                 event.preventDefault(); 
                 runTestButton.style.display = "none";
                 loadingModule.style.display = "block"; 
         
                 setTimeout(function() {
                     form.submit(); 
                 }, 3000); 
             });
         });
         });
      </script>
   </body>
</html>